### Модель Угроз для Windows-приложения, защищенного Avanguard и Oreans Themida (VM)

| Категория Угрозы | Конкретная Угроза | Защита от Oreans Themida (VM) | Защита от Avanguard | Дополнительные Замечания (Комбинированная Защита) |
| :--------------- | :---------------- | :---------------------------- | :------------------ | :----------------------------------------------- |
| **Реверс-инжиниринг и анализ кода** | Статическая/динамическая отладка | **Anti-Debugger Detection:** Обнаруживает отладчики ядра и ПО.<br>**Virtual Machine Protection:** Преобразует код в виртуальные инструкции, делая его нечитаемым для обычных дизассемблеров/отладчиков. Различные архитектуры VM для каждой защиты. | **Memory Filter:** Обнаруживает и предотвращает несанкционированный доступ к памяти, что может затруднить отладку и дампинг.<br>**DLL Filter:** Мониторит целостность модулей, предотвращая их модификацию для обхода защиты. | Themida сильно усложняет анализ кода и отладку. Avanguard добавляет дополнительный уровень защиты в рантайме, реагируя на попытки манипуляции памятью и модулями, что затрудняет обход Themida. |
| **Инъекции кода / DLL** | Инъекция вредоносных DLL/кода | **Advance API-Wrapping:** Обфусцирует вызовы API, усложняя идентификацию точек инъекции.<br>**Anti-File Patching:** Обнаруживает модификации защищенного приложения на диске. | **DLL Filter:** Мониторит загрузку DLL, проверяет их целостность, предотвращает загрузку неизвестных или модифицированных модулей.<br>**Memory Filter:** Отслеживает исполнительные регионы памяти, обнаруживая и предотвращая инъекции кода в память процесса. | Avanguard является основной линией обороны против инъекций, активно перехватывая и анализируя попытки внедрения. Themida обфусцирует целевое приложение, делая поиск уязвимостей для инъекций сложнее. |
| **Манипуляции памятью** | Изменение кода/данных в памяти (memory patching, дампинг) | **Virtual Machine Protection:** Код выполняется в виртуальной машине, затрудняя его модификацию в памяти.<br>**Compress and Encrypt:** Шифрует код и ресурсы, затрудняя их прямой доступ и модификацию в памяти.<br>**Is it possible to know from my application if the application has been unpacked?:** Предоставляет макрос для проверки распаковки. | **Memory Filter:** Активно мониторит исполнительную память, обнаруживает неизвестные или модифицированные регионы. Позволяет предотвращать модификации в рантайме. | Avanguard дополняет Themida, предоставляя активный мониторинг памяти в рантайме, который может обнаружить даже те попытки модификации, которые могли бы обойти статическую защиту Themida. |
| **Обход защиты / Атака на защиту** | Обход анти-отладочных проверок, обход VM | Themida включает множество **Extra Protection Options** (Anti-Sandbox, Detect File/Registry Monitors, Perform Protection checks on VM macros) и **SecureEngine® Macros** (`CheckProtection`, `CheckDebugger`, `CheckVirtualPC`) для обнаружения и реакции на попытки обхода. | **Threats Handler:** Централизованная система оповещения о любых обнаруженных угрозах (включая попытки обхода фильтров).<br>**DLL Filter/Memory Filter:** Любые попытки отключить или обойти эти фильтры могут быть обнаружены самой Avanguard. | Themida фокусируется на создании сложного барьера и активных проверок. Avanguard обеспечивает дополнительный уровень "сторожевого пса" на системном уровне, который может реагировать на попытки отключить или изменить саму Themida или защищаемое приложение после его загрузки. |
| **Анализ/Мониторинг поведения** | Мониторинг файловой системы, реестра, сетевой активности | **Detect File/Registry Monitors:** Обнаруживает распространенные инструменты мониторинга файлового и реестрового доступа. | *Не является основной функцией Avanguard. Avanguard больше фокусируется на процессах, памяти и DLL, нежели на мониторинге файловой/реестровой активности для обнаружения вредоносных программ.* | Themida имеет явную функцию для обнаружения таких мониторов, что является важным аспектом противодействия анализу поведения. |
| **Обход контроля потока выполнения** | ROP/JOP атаки, манипуляции стеком | Themida может применять **Entry Point Obfuscation** и **Virtual Machine protection** для запутывания потока выполнения, что усложняет построение ROP/JOP цепочек. | **Stacktrace Checker:** Обнаруживает аномалии в трассировке стека, что может быть индикатором ROP/JOP атак. | Avanguard предоставляет важную динамическую проверку целостности стека, которая может обнаружить аномалии, даже если Themida обфусцировала код. |
| **Запуск в виртуальных средах/песочницах** | Обнаружение и анализ в VM/Sandbox | **Anti-Sandbox:** Обнаруживает распространенные песочницы.<br>**Allow execution under VMWare/Virtual PC:** Опция для разрешения/запрета работы в ВМ. | *Напрямую не указано в описании модулей Avanguard, но косвенно может быть усилено общими анти-отладочными и анти-дампинговыми мерами.* | Themida предоставляет прямые механизмы для обнаружения и реагирования на запуск в виртуальных средах. |
| **Атаки на API (API Hooking)** | Перехват системных API вызовов | **Advance API-Wrapping:** Обфусцирует вызовы API, затрудняя их перехват. | **HookLib (Зависимость):** Avanguard сам использует техники хукинга для мониторинга. Это означает, что он способен обнаруживать другие хуки или конфликты с ними, а также перехватывать API для своей защиты. | Avanguard является экспертом в хукинге и его обнаружении. Themida обфусцирует API-вызовы, делая их сложнее для перехвата внешними инструментами. | 
